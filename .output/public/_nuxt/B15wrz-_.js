import{e as ne,j as se,U as ie,V as re,k as ue,W as de,T as ce,x as p,f as v,K as me,l as ve,m as pe,r,c as V,o as y,w as o,a as l,b as P,t as u,h as n,g as C,n as fe,d as f,p as he,H as _e}from"./CRyLGsn1.js";import{_ as ge}from"./DlAUqK2U.js";const ye={class:"text-h4 font-weight-bold"},we={class:"text-body-2 text-medium-emphasis px-2"},be={key:2,class:"text-center mb-4"},xe={class:"text-center"},ke={class:"text-body-2 mb-2"},Ve={class:"mb-4"},Pe=ne({__name:"auth",setup(Ce){const{t:e,locale:M}=se(),w=ie(),b=re(),{user:$,error:I,signIn:j,signUp:z,signInWithGoogle:G,resetPassword:W}=ue(),D=`${de}/${M.value}/auth`;ce({title:p(()=>e("auth.title")+" - "+e("meta.suffix")),meta:[{name:"description",content:p(()=>e("auth.meta.description"))},{property:"og:type",content:"website"},{property:"og:site_name",content:p(()=>e("meta.siteName"))},{property:"og:title",content:p(()=>e("auth.title")+" - "+e("meta.suffix"))},{property:"og:description",content:p(()=>e("auth.meta.description"))},{property:"og:url",content:D},{name:"twitter:title",content:p(()=>e("auth.title")+" - "+e("meta.suffix"))},{name:"twitter:description",content:p(()=>e("auth.meta.description"))},{name:"twitter:card",content:"summary_large_image"},{name:"robots",content:"noindex, nofollow"},{name:"language",content:p(()=>M.value)}]});const c=v("login"),N=v(!1),R=v(!1),x=v(!1),U=v(),d=v(null),m=v(null),h=v(!1),q=v(!1),_=v(""),i=me({email:"",password:"",confirmPassword:"",displayName:""}),T=[a=>!!a||e("auth.validation.emailRequired"),a=>/.+@.+\..+/.test(a)||e("auth.validation.emailInvalid")],F=[a=>!!a||e("auth.validation.passwordRequired"),a=>a.length>=6||e("auth.validation.passwordMinLength")],H=[a=>!!a||e("auth.validation.displayNameRequired"),a=>a.length>=2||e("auth.validation.displayNameMinLength")],K=p(()=>[a=>!!a||e("auth.validation.confirmPasswordRequired"),a=>a===i.password||e("auth.validation.passwordsNotMatch")]),O=()=>{c.value=c.value==="login"?"register":"login",d.value=null,m.value=null,Object.keys(i).forEach(a=>{i[a]=""}),_e(()=>{var a;(a=U.value)==null||a.resetValidation()})},J=async()=>{const{valid:a}=await U.value.validate();if(a){h.value=!0,d.value=null,m.value=null;try{c.value==="login"?(await j(i.email,i.password),m.value=e("auth.login.success"),setTimeout(()=>{b.push(w("/"))},1500)):(await z(i.email,i.password,i.displayName),m.value=e("auth.register.success"),setTimeout(()=>{b.push(w("/"))},1500))}catch{d.value=I.value||e("auth.error.generic")}finally{h.value=!1}}},Q=async()=>{if(!_.value||!/.+@.+\..+/.test(_.value)){d.value=e("auth.validation.emailInvalid");return}q.value=!0,d.value=null;try{await W(_.value),m.value=e("auth.resetPassword.success"),x.value=!1,_.value=""}catch{d.value=I.value||e("auth.error.generic")}finally{q.value=!1}},X=async()=>{h.value=!0,d.value=null,m.value=null;try{await G(),m.value=e("auth.login.success"),setTimeout(()=>{b.push(w("/"))},1500)}catch(a){console.error(a),d.value=I.value||e("auth.error.generic")}finally{h.value=!1}};return ve($,a=>{a&&b.push(w("/"))}),pe(()=>{$.value&&b.push(w("/"))}),(a,t)=>{const L=r("v-card-title"),A=r("v-alert"),k=r("v-text-field"),g=r("v-btn"),B=r("v-divider"),Y=r("v-form"),E=r("v-card-text"),S=r("v-card"),Z=r("v-col"),ee=r("v-row"),ae=r("v-spacer"),te=r("v-card-actions"),le=r("v-dialog"),oe=r("v-container");return y(),V(oe,{class:"auth-container"},{default:o(()=>[l(ee,{justify:"center"},{default:o(()=>[l(Z,{cols:"12",sm:"8",md:"6",lg:"4"},{default:o(()=>[l(S,{class:"auth-card",elevation:"10"},{default:o(()=>[l(L,{class:"text-center py-6"},{default:o(()=>[P("h1",ye,u(c.value==="login"?n(e)("auth.login.title"):n(e)("auth.register.title")),1)]),_:1}),l(E,{class:"pt-6"},{default:o(()=>[d.value?(y(),V(A,{key:0,type:"error",variant:"tonal",class:"mb-4",closable:"","onClick:close":t[0]||(t[0]=s=>d.value=null)},{default:o(()=>[f(u(d.value),1)]),_:1})):C("",!0),m.value?(y(),V(A,{key:1,type:"success",variant:"tonal",class:"mb-4",closable:"","onClick:close":t[1]||(t[1]=s=>m.value=null)},{default:o(()=>[f(u(m.value),1)]),_:1})):C("",!0),l(Y,{ref_key:"formRef",ref:U,onSubmit:he(J,["prevent"])},{default:o(()=>[c.value==="register"?(y(),V(k,{key:0,modelValue:i.displayName,"onUpdate:modelValue":t[2]||(t[2]=s=>i.displayName=s),label:n(e)("auth.displayName"),rules:H,variant:"outlined","prepend-inner-icon":"mdi-account",class:"mb-3",required:""},null,8,["modelValue","label"])):C("",!0),l(k,{modelValue:i.email,"onUpdate:modelValue":t[3]||(t[3]=s=>i.email=s),label:n(e)("auth.email"),rules:T,variant:"outlined",type:"email","prepend-inner-icon":"mdi-email",class:"mb-3",required:""},null,8,["modelValue","label"]),l(k,{modelValue:i.password,"onUpdate:modelValue":t[4]||(t[4]=s=>i.password=s),label:n(e)("auth.password"),rules:F,variant:"outlined",type:N.value?"text":"password","prepend-inner-icon":"mdi-lock","append-inner-icon":N.value?"mdi-eye":"mdi-eye-off","onClick:appendInner":t[5]||(t[5]=s=>N.value=!N.value),class:"mb-3",required:""},null,8,["modelValue","label","type","append-inner-icon"]),c.value==="register"?(y(),V(k,{key:1,modelValue:i.confirmPassword,"onUpdate:modelValue":t[6]||(t[6]=s=>i.confirmPassword=s),label:n(e)("auth.confirmPassword"),rules:K.value,variant:"outlined",type:R.value?"text":"password","prepend-inner-icon":"mdi-lock-check","append-inner-icon":R.value?"mdi-eye":"mdi-eye-off","onClick:appendInner":t[7]||(t[7]=s=>R.value=!R.value),class:"mb-4",required:""},null,8,["modelValue","label","rules","type","append-inner-icon"])):C("",!0),l(g,{type:"submit",color:"primary",size:"large",block:"",loading:h.value,class:"text-none mb-4 w-100"},{default:o(()=>[f(u(c.value==="login"?n(e)("auth.login.submit"):n(e)("auth.register.submit")),1)]),_:1},8,["loading"]),l(B,{class:"my-4"},{default:o(()=>[P("span",we,u(n(e)("auth.orDivider")),1)]),_:1}),l(g,{onClick:X,color:"white",variant:"outlined",size:"large",block:"",loading:h.value,class:"text-none mb-4 w-100","prepend-icon":"mdi-google"},{default:o(()=>[f(u(n(e)("auth.signInWithGoogle")),1)]),_:1},8,["loading"])]),_:1},512),c.value==="login"?(y(),fe("div",be,[l(g,{variant:"text",color:"primary",size:"small",onClick:t[8]||(t[8]=s=>x.value=!0)},{default:o(()=>[f(u(n(e)("auth.forgotPassword")),1)]),_:1})])):C("",!0),l(B,{class:"my-4"}),P("div",xe,[P("p",ke,u(c.value==="login"?n(e)("auth.noAccount"):n(e)("auth.hasAccount")),1),l(g,{variant:"text",color:"primary",onClick:O},{default:o(()=>[f(u(c.value==="login"?n(e)("auth.register.link"):n(e)("auth.login.link")),1)]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1}),l(le,{modelValue:x.value,"onUpdate:modelValue":t[11]||(t[11]=s=>x.value=s),"max-width":"500"},{default:o(()=>[l(S,null,{default:o(()=>[l(L,{class:"text-h5"},{default:o(()=>[f(u(n(e)("auth.resetPassword.title")),1)]),_:1}),l(E,null,{default:o(()=>[P("p",Ve,u(n(e)("auth.resetPassword.description")),1),l(k,{modelValue:_.value,"onUpdate:modelValue":t[9]||(t[9]=s=>_.value=s),label:n(e)("auth.email"),variant:"outlined",type:"email","prepend-inner-icon":"mdi-email",rules:T},null,8,["modelValue","label"])]),_:1}),l(te,null,{default:o(()=>[l(ae),l(g,{variant:"text",onClick:t[10]||(t[10]=s=>x.value=!1)},{default:o(()=>[f(u(n(e)("auth.cancel")),1)]),_:1}),l(g,{color:"primary",variant:"flat",loading:q.value,onClick:Q},{default:o(()=>[f(u(n(e)("auth.resetPassword.submit")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),Ie=ge(Pe,[["__scopeId","data-v-27f3f4df"]]);export{Ie as default};
