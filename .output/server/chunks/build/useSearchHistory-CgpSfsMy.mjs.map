{"version":3,"file":"useSearchHistory-CgpSfsMy.mjs","sources":["../../../../utils/storage.ts","../../../../composables/useSearchHistory.ts"],"sourcesContent":null,"names":["constructor","u","this","init","isIndexedDBSupported","Promise","resolve","reject","request","indexedDB","open","dbName","version","onerror","console","error","onsuccess","db","result","onupgradeneeded","a","event","target","objectStoreNames","contains","storeName","store","createObjectStore","keyPath","createIndex","unique","log","addSearch","item","addOrUpdateIndexedDBOptimized","addOrUpdateLocalStorage","id","phoneNumber","Date","now","searchDate","getSearchHistory","getFromIndexedDB","getFromLocalStorage","clearHistory","clearIndexedDB","clearLocalStorage","deleteSearch","deleteFromIndexedDB","deleteFromLocalStorage","transaction","objectStore","getRequest","index","get","existingItem","searchItem","toISOString","data","JSON","parse","stringify","putRequest","put","l","addOrUpdateIndexedDB","isUpdate","serializedItem","add","c","openCursor","results","cursor","value","push","continue","clear","s","delete","o","existingData","localStorage","getItem","filteredHistory","filter","h","unshift","limitedHistory","slice","setItem","map","r","sort","b","getTime","removeItem","useSearchHistory","searchHistory","ref","loading","initializeStorage","async","addSearchToHistory","loadSearchHistory","clearAllHistory","deleteSearchItem","downloadImage","url","filename","blob","fetch","blobURL","URL","createObjectURL","createElement","href","style","display","download","body","appendChild","click","removeChild","revokeObjectURL","err"],"mappings":"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"}