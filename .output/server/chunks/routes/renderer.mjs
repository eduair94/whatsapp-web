import{getRequestDependencies as t,getPreloadLinks as e,getPrefetchLinks as o}from"vue-bundle-renderer/runtime";import{P as r,Q as s,R as n,S as a,T as i,U as d,V as p,W as l,g as u,m as h,X as m,Y as c,Z as y,_ as f,$ as b,a0 as _,a1 as g,a2 as w,N as x}from"../_/nitro.mjs";import{stringify as j,uneval as C}from"devalue";import{propsToString as A,renderSSRHead as T}from"unhead/server";import"fs";import"os";import"path";import"url";import"http";import"https";import"events";import"zlib";import"@fastify/busboy";import"jsonwebtoken";import"node-forge";import"crypto";import"jwks-rsa";import"bcryptjs";import"mongoose";import"lru-cache";import"@unocss/core";import"@unocss/preset-wind3";import"consola";import"unhead";import"node:http";import"node:https";import"node:events";import"node:buffer";import"vue";import"node:fs";import"node:url";import"unhead/plugins";import"unhead/utils";import"vue/server-renderer";import"node:path";import"node:crypto";function renderPayloadJsonScript(t){const e={type:"application/json",innerHTML:t.data?j(t.data,t.ssrContext._payloadReducers):"","data-nuxt-data":n,"data-ssr":!t.ssrContext.noSSR,id:"__NUXT_DATA__"};t.src&&(e["data-src"]=t.src);return[e,{innerHTML:`window.__NUXT__={};window.__NUXT__.config=${C(t.ssrContext.config)}`}]}function splitPayload(t){const{data:e,prerenderedAt:o,...r}=t.payload;return{initial:{...r,prerenderedAt:o},payload:{data:e,prerenderedAt:o}}}const k={omitLineBreaks:!1};globalThis.__buildAssetsURL=i,globalThis.__publicAssetsURL=d;const v=!!l.id,R=v?`<${p}${A(l)}>`:"",$=v?`</${p}>`:"",P=/^[^?]*\/_payload.json(?:\?.*)?$/,S=a((async n=>{const a=x(),d=n.path.startsWith("/__nuxt_error")?u(n):null;if(d&&!("__unenv__"in n.node.req))throw h({statusCode:404,statusMessage:"Page Not Found: /__nuxt_error"});const p=m(n),C={mode:"server"};p.head.push(c,C),d&&(d.statusCode&&=Number.parseInt(d.statusCode),y(p,d));const A=P.test(p.url);if(A){const t=p.url.substring(0,p.url.lastIndexOf("/"))||"/";p.url=t,n._path=n.node.req.url=t}const S=f(n);!1===S.ssr&&(p.noSSR=!0);const N=await b(p);for(const t of await _())p.modules.add(t);const U=await N.renderToString(p).catch((async t=>{if(p._renderResponse&&"skipping render"===t.message)return{};const e=!d&&p.payload?.error||t;throw await(p.nuxt?.hooks.callHook("app:error",e)),e})),L=p._renderResponse||A?[]:await g(p.modules??[]);if(await(p.nuxt?.hooks.callHook("app:rendered",{ssrContext:p,renderResult:U})),p._renderResponse)return p._renderResponse;if(p.payload?.error&&!d)throw p.payload.error;if(A){const t=function(t){return{body:j(splitPayload(t).payload,t._payloadReducers),statusCode:s(t.event),statusMessage:r(t.event),headers:{"content-type":"application/json;charset=utf-8","x-powered-by":"Nuxt"}}}(p);return t}const M=S.noScripts,{styles:H,scripts:O}=t(p,N.rendererContext);p._preloadManifest&&!M&&p.head.push({link:[{rel:"preload",as:"fetch",fetchpriority:"low",crossorigin:"anonymous",href:i(`builds/meta/${p.runtimeConfig.app.buildId}.json`)}]},{...C,tagPriority:"low"}),L.length&&p.head.push({style:L});const z=[];for(const t of Object.values(H))z.push({rel:"stylesheet",href:N.rendererContext.buildAssetsURL(t.file),crossorigin:""});z.length&&p.head.push({link:z},C),M||(p.head.push({link:e(p,N.rendererContext)},C),p.head.push({link:o(p,N.rendererContext)},C),p.head.push({script:renderPayloadJsonScript({ssrContext:p,data:p.payload})},{...C,tagPosition:"bodyClose",tagPriority:"high"})),S.noScripts||p.head.push({script:Object.values(O).map((t=>({type:t.module?"module":null,src:N.rendererContext.buildAssetsURL(t.file),defer:!t.module||null,tagPosition:"head",crossorigin:""})))},C);const{headTags:X,bodyTags:I,bodyTagsOpen:q,htmlAttrs:B,bodyAttrs:D}=await T(p.head,k),J={htmlAttrs:B?[B]:[],head:normalizeChunks([X]),bodyAttrs:D?[D]:[],bodyPrepend:normalizeChunks([q,p.teleports?.body]),body:[w(p,U.html),R+(v?joinTags([p.teleports?.[`#${l.id}`]]):"")+$],bodyAppend:[I]};return await a.hooks.callHook("render:html",J,{event:n}),{body:(W=J,`<!DOCTYPE html><html${joinAttrs(W.htmlAttrs)}><head>${joinTags(W.head)}</head><body${joinAttrs(W.bodyAttrs)}>${joinTags(W.bodyPrepend)}${joinTags(W.body)}${joinTags(W.bodyAppend)}</body></html>`),statusCode:s(n),statusMessage:r(n),headers:{"content-type":"text/html;charset=utf-8","x-powered-by":"Nuxt"}};var W}));function normalizeChunks(t){return t.filter(Boolean).map((t=>t.trim()))}function joinTags(t){return t.join("")}function joinAttrs(t){return 0===t.length?"":" "+t.join(" ")}export{S as default};
//# sourceMappingURL=renderer.mjs.map
